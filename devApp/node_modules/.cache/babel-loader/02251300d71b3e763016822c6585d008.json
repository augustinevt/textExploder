{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.beats = exports.stopSectionChain = exports.playSectionChain = exports.stopWorkbench = exports.playWorkbench = void 0;\n\nvar _tone = _interopRequireDefault(require(\"tone\"));\n\nvar _patternMaker = require(\"./patternMaker\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar synth = new _tone[\"default\"].PolySynth(6, _tone[\"default\"].Synth).toMaster(); // let i = 0;\n\nvar obj = {\n  currProgWork: null,\n  currSectionChain: null\n};\n\nvar playWorkbench = function playWorkbench(_ref) {\n  var sections = _ref.sections,\n      stateUpdater = _ref.stateUpdater,\n      params = _ref.params;\n\n  if (sections.length === 0) {\n    return;\n  }\n\n  var section = sections[0];\n  var chords = section.chordNotes.map(function (notes, i) {\n    return {\n      time: \"\".concat(i),\n      notes: notes\n    };\n  });\n  var pattern = params.pattern;\n  var newPattern = chords.map(function (measure, i) {\n    return _objectSpread({}, pattern[i], {}, measure);\n  }); // const pattern = getPattern(params.pattern, chords);\n\n  var part = new _tone[\"default\"].Part(function (time, value) {\n    stateUpdater({\n      i: time\n    });\n    synth.triggerAttackRelease(value.notes, value.duration, time);\n  }, newPattern);\n\n  _tone[\"default\"].Transport.start();\n\n  part.loop = true;\n  part.loopStart = 0;\n  part.loopEnd = \"4m\";\n  part.start(0);\n  obj.currProgWork = part;\n};\n\nexports.playWorkbench = playWorkbench;\n\nvar stopWorkbench = function stopWorkbench() {\n  obj.currProgWork.stop();\n  obj.currProgWork.dispose();\n\n  _tone[\"default\"].Transport.stop();\n};\n\nexports.stopWorkbench = stopWorkbench;\n\nvar playSectionChain = function playSectionChain(_ref2) {\n  var sections = _ref2.sections,\n      stateUpdater = _ref2.stateUpdater;\n\n  if (sections.length === 0) {\n    return;\n  }\n\n  var playableSections = [];\n  sections.reduce(function (runningMeasures, section) {\n    section.chordNotes.forEach(function (notes, j) {\n      playableSections.push({\n        time: \"\".concat(runningMeasures, \":0\"),\n        notes: notes\n      });\n      runningMeasures += 1;\n    });\n    return runningMeasures;\n  }, 0);\n  var part = new _tone[\"default\"].Part(function (time, value) {\n    stateUpdater({\n      i: time\n    });\n    console.log(value.notes);\n    synth.triggerAttackRelease(value.notes, \"4n\", time);\n  }, playableSections);\n\n  _tone[\"default\"].Transport.cancel();\n\n  _tone[\"default\"].Transport.position = 0;\n\n  _tone[\"default\"].Transport.start();\n\n  part.start(0);\n  obj.currSectionChain = part;\n};\n\nexports.playSectionChain = playSectionChain;\n\nvar stopSectionChain = function stopSectionChain() {\n  obj.currSectionChain.stop();\n  obj.currSectionChain.dispose();\n}; //////// BEATS\n\n\nexports.stopSectionChain = stopSectionChain;\nvar kick = new _tone[\"default\"].MembraneSynth({\n  'envelope': {\n    'sustain': 0,\n    'attack': 0.02,\n    'decay': 0.8\n  },\n  'octaves': 10\n}).toMaster();\nvar snare = new _tone[\"default\"].NoiseSynth({\n  'volume': -5,\n  'envelope': {\n    'attack': 0.001,\n    'decay': 0.2,\n    'sustain': 0\n  },\n  'filterEnvelope': {\n    'attack': 0.001,\n    'decay': 0.1,\n    'sustain': 0\n  }\n}).toMaster();\nvar beatBank = {\n  \"default\": {\n    kick: [[\"0:0\", \"C2\"], [\"0:1\", \"C2\"], [\"0:2\", \"C3\"], [\"0:3\", \"G2\"], [\"1:0\", \"C2\"], [\"1:1\", \"C2\"], [\"1:2\", \"C3\"], [\"1:3\", \"G2\"], [\"2:0\", \"C2\"], [\"2:1\", \"C2\"], [\"2:2\", \"C3\"], [\"2:3\", \"G2\"], [\"3:0\", \"C2\"], [\"3:1\", \"C2\"], [\"3:2\", \"C3\"], [\"3:3\", \"G2\"]],\n    snare: [[\"0:0:2\", \"C2\"], [\"0:1:2\", \"C3\"], [\"0:2:2\", \"G2\"], [\"0:3:2\", \"G2\"], [\"1:0:2\", \"C2\"], [\"1:1:2\", \"C3\"], [\"1:2:2\", \"G2\"], [\"1:3:2\", \"G2\"], [\"2:0:2\", \"C2\"], [\"2:1:2\", \"C3\"], [\"2:2:2\", \"G2\"], [\"2:3:2\", \"G2\"], [\"3:0:2\", \"C2\"], [\"3:1:2\", \"C3\"], [\"3:2:2\", \"G2\"], [\"3:3:2\", \"G2\"], [\"3:3:3\", \"G2\"]]\n  },\n  yas: {\n    kick: [[\"0:3\", \"C2\"], [\"0:2\", \"C2\"], [\"0:2\", \"C3\"], [\"0:7\", \"G2\"], [\"1:0\", \"C2\"], [\"1:1\", \"C2\"], [\"1:2\", \"C3\"], [\"1:3\", \"G2\"], [\"2:4\", \"C2\"], [\"2:1\", \"C2\"], [\"2:2\", \"C3\"], [\"2:3\", \"G2\"], [\"3:0\", \"C2\"], [\"3:1\", \"C2\"], [\"3:2\", \"C3\"], [\"3:3\", \"G2\"]],\n    snare: [[\"0:1:2\", \"C2\"], [\"0:1:2\", \"C3\"], [\"0:1:3\", \"G2\"], [\"0:3:2\", \"G2\"], [\"1:0:2\", \"C2\"], [\"1:1:2\", \"C3\"], [\"1:2:2\", \"G2\"], [\"1:3:2\", \"G2\"], [\"2:0:2\", \"C2\"], [\"2:1:2\", \"C3\"], [\"2:2:2\", \"G2\"], [\"2:3:2\", \"G2\"], [\"3:0:2\", \"C2\"], [\"3:1:2\", \"C3\"], [\"3:2:2\", \"G2\"], [\"3:3:2\", \"G2\"], [\"3:3:3\", \"G2\"]]\n  }\n};\n\nvar beats = function beats() {\n  var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'default';\n  var beat = beatBank[key];\n  var kickPart = new _tone[\"default\"].Part(function (time) {\n    kick.triggerAttackRelease('C2', '8n', time);\n  }, beat.kick);\n  var snarePart = new _tone[\"default\"].Part(function (time) {\n    snare.triggerAttackRelease(time);\n  }, beat.snare);\n  kickPart.loop = true;\n  kickPart.loopStart = 0;\n  kickPart.loopEnd = \"4m\";\n  kickPart.start(0);\n  snarePart.loop = true;\n  snarePart.loopStart = 0;\n  snarePart.loopEnd = \"4m\";\n  snarePart.start(0);\n\n  _tone[\"default\"].Transport.start();\n};\n\nexports.beats = beats;\nvar _default = {\n  beats: beats,\n  stopWorkbench: stopWorkbench,\n  playWorkbench: playWorkbench,\n  stopSectionChain: stopSectionChain,\n  playSectionChain: playSectionChain\n};\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}